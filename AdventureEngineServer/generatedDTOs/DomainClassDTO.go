//*** CAUTION ***
//This is an autogenerated file produced by regenerateBackend.py.
//Edits made here will not persist after backend regeneration.

package generatedDTOs

import (
   types "AdventureEngineServer/generatedDatabaseTypes"
   utils "AdventureEngineServer/utils"
   services "AdventureEngineServer/generatedServices"
   "gorm.io/gorm"
   "fmt"
   "reflect"
   "slices"
)

type DomainClassDTOAttributes struct {
   AbbreviatedTitle *string
   Description *string
   
   IsActive *bool
   Title *string
}

type DomainClassDTOManyToOneRelationships struct {
   HitDie__DomainDice *DomainDiceDTO
   SpellcastingStat__DomainCharacterStat *DomainCharacterStatDTO
}

type DomainClassDTOOneToManyRelationships struct {
   PrimaryStats__ClassPrimaryAbility []*ClassPrimaryAbilityDTO
   Saves__ClassSave []*ClassSaveDTO
   SubClasses__DomainSubClass []*DomainSubClassDTO
}

type DomainClassDTORelationships struct {
   ManyToOne DomainClassDTOManyToOneRelationships
   OneToMany DomainClassDTOOneToManyRelationships
}

type DomainClassDTO struct {
   Id *int
   
   Attributes DomainClassDTOAttributes
   
   Relationships DomainClassDTORelationships
}

func DomainClassToDomainClassDTO(db *gorm.DB, domainClass *types.DomainClass, traversedTables []string) *DomainClassDTO {
   
   if (domainClass == nil) {
      fmt.Println("Nil pointer passed to DTO conversion for table DomainClass")
      return nil
   }
   
   if (slices.Contains(traversedTables, reflect.TypeOf(*domainClass).Name())) {
      fmt.Println("Hit circular catch case for table DomainClass")
      return nil
   }
   
   traversedTables = append(traversedTables, reflect.TypeOf(*domainClass).Name())
   
   var includedHitDie__DomainDice types.DomainDice
   var includedSpellcastingStat__DomainCharacterStat types.DomainCharacterStat
   var includedPrimaryStats__ClassPrimaryAbilitys []types.ClassPrimaryAbility
   var includedSaves__ClassSaves []types.ClassSave
   var includedSubClasses__DomainSubClasss []types.DomainSubClass
   
   if (domainClass.HitDie__DomainDice != nil) {
      if err := services.GetDomainDiceById(db, int(*domainClass.HitDie__DomainDice), &includedHitDie__DomainDice); err != nil {
         fmt.Println("Error fetching many-to-one table DomainDice:")
         fmt.Println(err)
      }
   }

   if (domainClass.SpellcastingStat__DomainCharacterStat != nil) {
      if err := services.GetDomainCharacterStatById(db, int(*domainClass.SpellcastingStat__DomainCharacterStat), &includedSpellcastingStat__DomainCharacterStat); err != nil {
         fmt.Println("Error fetching many-to-one table DomainCharacterStat:")
         fmt.Println(err)
      }
   }

   if (slices.Contains(traversedTables, reflect.TypeOf(includedPrimaryStats__ClassPrimaryAbilitys).Elem().Name())) {
      includedPrimaryStats__ClassPrimaryAbilitys = []types.ClassPrimaryAbility{}
      fmt.Println("Hit circular catch case for table ClassPrimaryAbility")
   } else {
      services.GetClassPrimaryAbilitysByDomainClassId(db, int(*domainClass.Id), &includedPrimaryStats__ClassPrimaryAbilitys)
   }

   if (slices.Contains(traversedTables, reflect.TypeOf(includedSaves__ClassSaves).Elem().Name())) {
      includedSaves__ClassSaves = []types.ClassSave{}
      fmt.Println("Hit circular catch case for table ClassSave")
   } else {
      services.GetClassSavesByDomainClassId(db, int(*domainClass.Id), &includedSaves__ClassSaves)
   }

   if (slices.Contains(traversedTables, reflect.TypeOf(includedSubClasses__DomainSubClasss).Elem().Name())) {
      includedSubClasses__DomainSubClasss = []types.DomainSubClass{}
      fmt.Println("Hit circular catch case for table DomainSubClass")
   } else {
      services.GetDomainSubClasssByDomainClassId(db, int(*domainClass.Id), &includedSubClasses__DomainSubClasss)
   }

   
   return &DomainClassDTO{
      Id: domainClass.Id,
      Attributes: DomainClassDTOAttributes{
         AbbreviatedTitle: domainClass.AbbreviatedTitle,
         Description: domainClass.Description,
         
         IsActive: domainClass.IsActive,
         Title: domainClass.Title,
      },
      Relationships: DomainClassDTORelationships{
         ManyToOne: DomainClassDTOManyToOneRelationships {
            HitDie__DomainDice: DomainDiceToDomainDiceDTO(db, &includedHitDie__DomainDice, traversedTables),
            SpellcastingStat__DomainCharacterStat: DomainCharacterStatToDomainCharacterStatDTO(db, &includedSpellcastingStat__DomainCharacterStat, traversedTables),
         },
         OneToMany: DomainClassDTOOneToManyRelationships {
            PrimaryStats__ClassPrimaryAbility: utils.Map(includedPrimaryStats__ClassPrimaryAbilitys, func(relationshipElement types.ClassPrimaryAbility) *ClassPrimaryAbilityDTO { return ClassPrimaryAbilityToClassPrimaryAbilityDTO(db, &relationshipElement, traversedTables) }),
            Saves__ClassSave: utils.Map(includedSaves__ClassSaves, func(relationshipElement types.ClassSave) *ClassSaveDTO { return ClassSaveToClassSaveDTO(db, &relationshipElement, traversedTables) }),
            SubClasses__DomainSubClass: utils.Map(includedSubClasses__DomainSubClasss, func(relationshipElement types.DomainSubClass) *DomainSubClassDTO { return DomainSubClassToDomainSubClassDTO(db, &relationshipElement, traversedTables) }),
         },
      },
   }
}

func DomainClassDTOToDomainClass(domainClass *DomainClassDTO) *types.DomainClass {
   var tableTypeBuffer types.DomainClass
   
   tableTypeBuffer.Id = domainClass.Id
   tableTypeBuffer.AbbreviatedTitle = domainClass.Attributes.AbbreviatedTitle
   tableTypeBuffer.Description = domainClass.Attributes.Description
   
   tableTypeBuffer.IsActive = domainClass.Attributes.IsActive
   tableTypeBuffer.Title = domainClass.Attributes.Title
   
   if (domainClass.Relationships.ManyToOne.HitDie__DomainDice != nil) {
      tableTypeBuffer.HitDie__DomainDice = domainClass.Relationships.ManyToOne.HitDie__DomainDice.Id
   }

   if (domainClass.Relationships.ManyToOne.SpellcastingStat__DomainCharacterStat != nil) {
      tableTypeBuffer.SpellcastingStat__DomainCharacterStat = domainClass.Relationships.ManyToOne.SpellcastingStat__DomainCharacterStat.Id
   }

   return &tableTypeBuffer
}

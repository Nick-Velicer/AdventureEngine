//*** CAUTION ***
//This is an autogenerated file produced by regenerateBackend.py.
//Edits made here will not persist after backend regeneration.

package generatedDTOs

import (
   types "AdventureEngineServer/generatedDatabaseTypes"
   utils "AdventureEngineServer/utils"
   services "AdventureEngineServer/generatedServices"
   "gorm.io/gorm"
   "reflect"
   "slices"
)

type CharacterDTOAttributes struct {
   Description *string
   
   IsActive *bool
   Title *string
}

type CharacterDTOManyToOneRelationships struct {
   Campaign__Campaign *CampaignDTO
   CurrentSize__DomainSize *DomainSizeDTO
   Species__DomainSpecies *DomainSpeciesDTO
}

type CharacterDTOOneToManyRelationships struct {
   Stats__CharacterDomainCharacterStatInstance []*CharacterDomainCharacterStatInstanceDTO
   SubClasses__CharacterDomainSubClassInstance []*CharacterDomainSubClassInstanceDTO
}

type CharacterDTORelationships struct {
   ManyToOne CharacterDTOManyToOneRelationships
   OneToMany CharacterDTOOneToManyRelationships
}

type CharacterDTO struct {
   Id *int
   
   Attributes CharacterDTOAttributes
   
   Relationships CharacterDTORelationships
}

func CharacterToCharacterDTO(db *gorm.DB, character *types.Character, traversedTables []string) *CharacterDTO {
   
   if (character == nil) {
      print("Nil pointer passed to DTO conversion for table Character\n")
      return nil
   }
   
   if (slices.Contains(traversedTables, reflect.TypeOf(*character).Name())) {
      print("Hit circular catch case for table Character\n")
      return nil
   }
   
   traversedTables = append(traversedTables, reflect.TypeOf(*character).Name())
   
   var includedCampaign__Campaign *types.Campaign
   var includedCurrentSize__DomainSize *types.DomainSize
   var includedSpecies__DomainSpecies *types.DomainSpecies
   var includedStats__CharacterDomainCharacterStatInstances []types.CharacterDomainCharacterStatInstance
   var includedSubClasses__CharacterDomainSubClassInstances []types.CharacterDomainSubClassInstance
   
   if (character.Campaign__Campaign != nil) {
      services.GetCampaignById(db, int(*character.Campaign__Campaign), includedCampaign__Campaign)
   }

   if (character.CurrentSize__DomainSize != nil) {
      services.GetDomainSizeById(db, int(*character.CurrentSize__DomainSize), includedCurrentSize__DomainSize)
   }

   if (character.Species__DomainSpecies != nil) {
      services.GetDomainSpeciesById(db, int(*character.Species__DomainSpecies), includedSpecies__DomainSpecies)
   }

   if (slices.Contains(traversedTables, reflect.TypeOf(includedStats__CharacterDomainCharacterStatInstances).Elem().Name())) {
      services.GetCharacterDomainCharacterStatInstancesByCharacterId(db, int(*character.Id), &includedStats__CharacterDomainCharacterStatInstances)
   } else {
      includedStats__CharacterDomainCharacterStatInstances = []types.CharacterDomainCharacterStatInstance{}
      print("Hit circular catch case for table CharacterDomainCharacterStatInstance\n")
   }

   if (slices.Contains(traversedTables, reflect.TypeOf(includedSubClasses__CharacterDomainSubClassInstances).Elem().Name())) {
      services.GetCharacterDomainSubClassInstancesByCharacterId(db, int(*character.Id), &includedSubClasses__CharacterDomainSubClassInstances)
   } else {
      includedSubClasses__CharacterDomainSubClassInstances = []types.CharacterDomainSubClassInstance{}
      print("Hit circular catch case for table CharacterDomainSubClassInstance\n")
   }

   
   return &CharacterDTO{
      Id: character.Id,
      Attributes: CharacterDTOAttributes{
         Description: character.Description,
         
         IsActive: character.IsActive,
         Title: character.Title,
      },
      Relationships: CharacterDTORelationships{
         ManyToOne: CharacterDTOManyToOneRelationships {
            Campaign__Campaign: CampaignToCampaignDTO(db, includedCampaign__Campaign, traversedTables),
            CurrentSize__DomainSize: DomainSizeToDomainSizeDTO(db, includedCurrentSize__DomainSize, traversedTables),
            Species__DomainSpecies: DomainSpeciesToDomainSpeciesDTO(db, includedSpecies__DomainSpecies, traversedTables),
         },
         OneToMany: CharacterDTOOneToManyRelationships {
            Stats__CharacterDomainCharacterStatInstance: utils.Map(includedStats__CharacterDomainCharacterStatInstances, func(relationshipElement types.CharacterDomainCharacterStatInstance) *CharacterDomainCharacterStatInstanceDTO { return CharacterDomainCharacterStatInstanceToCharacterDomainCharacterStatInstanceDTO(db, &relationshipElement, traversedTables) }),
            SubClasses__CharacterDomainSubClassInstance: utils.Map(includedSubClasses__CharacterDomainSubClassInstances, func(relationshipElement types.CharacterDomainSubClassInstance) *CharacterDomainSubClassInstanceDTO { return CharacterDomainSubClassInstanceToCharacterDomainSubClassInstanceDTO(db, &relationshipElement, traversedTables) }),
         },
      },
   }
}

func CharacterDTOToCharacter(character *CharacterDTO) *types.Character {
   var tableTypeBuffer types.Character
   
   tableTypeBuffer.Id = character.Id
   tableTypeBuffer.Description = character.Attributes.Description
   
   tableTypeBuffer.IsActive = character.Attributes.IsActive
   tableTypeBuffer.Title = character.Attributes.Title
   
   if (character.Relationships.ManyToOne.Campaign__Campaign != nil) {
      tableTypeBuffer.Campaign__Campaign = character.Relationships.ManyToOne.Campaign__Campaign.Id
   }

   if (character.Relationships.ManyToOne.CurrentSize__DomainSize != nil) {
      tableTypeBuffer.CurrentSize__DomainSize = character.Relationships.ManyToOne.CurrentSize__DomainSize.Id
   }

   if (character.Relationships.ManyToOne.Species__DomainSpecies != nil) {
      tableTypeBuffer.Species__DomainSpecies = character.Relationships.ManyToOne.Species__DomainSpecies.Id
   }

   return &tableTypeBuffer
}
